<export-ma server='MIM2022' export-date='2025-10-04 22:54:19.836'>
<!--WARNING>
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!
!! The contents of this file should not be edited.
!! Any such modifications to this file may result in errors during import.
!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
</WARNING-->
<ma-data>
 <format-version>1</format-version>
 <id>{44D74A23-B80A-4BBD-9F1A-70E0781A5C0D}</id>
 <name>PSMA7</name>
 <category>Extensible2</category>
 <subtype>PowerShell</subtype>
 <ma-listname>PowerShell</ma-listname>
 <ma-companyname>Soren Granfeldt</ma-companyname>
 <creation-time>2025-10-04 22:40:50.686</creation-time>
 <last-modification-time>2025-10-04 22:40:50.686</last-modification-time>
 <version>1</version>
 <internal-version>1</internal-version>
 <password-sync-allowed>0</password-sync-allowed>
 <schema>
  <dsml:dsml xmlns:ms-dsml="http://www.microsoft.com/MMS/DSML" xmlns:dsml="http://www.dsml.org/DSML"><dsml:directory-schema ms-dsml:no-objectclass-validation="true"><dsml:class id="person" type="structural" ms-dsml:locked="1"><dsml:name>person</dsml:name><dsml:attribute ref="#USER_FIRST_NAME" required="false" ms-dsml:isAnchor="false" /><dsml:attribute ref="#USER_LAST_NAME" required="false" ms-dsml:isAnchor="false" /><dsml:attribute ref="#EMAIL" required="false" ms-dsml:isAnchor="false" /><dsml:attribute ref="#STREET" required="false" ms-dsml:isAnchor="false" /><dsml:attribute ref="#CITY_STATE" required="false" ms-dsml:isAnchor="false" /><dsml:attribute ref="#ZIP" required="false" ms-dsml:isAnchor="false" /><dsml:attribute ref="#USER_ID" required="true" ms-dsml:isAnchor="true" /><dsml:attribute ref="#export_password" required="false" /></dsml:class><dsml:attribute-type id="USER_FIRST_NAME" single-value="true"><dsml:name>USER_FIRST_NAME</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="USER_LAST_NAME" single-value="true"><dsml:name>USER_LAST_NAME</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="EMAIL" single-value="true"><dsml:name>EMAIL</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="STREET" single-value="true"><dsml:name>STREET</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="CITY_STATE" single-value="true"><dsml:name>CITY_STATE</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="ZIP" single-value="true"><dsml:name>ZIP</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="USER_ID" single-value="true" ms-dsml:immutable="true"><dsml:name>USER_ID</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type><dsml:attribute-type id="export_password" single-value="true" ms-dsml:encrypted="true" ms-dsml:export-only="true"><dsml:name>export_password</dsml:name><dsml:syntax>1.3.6.1.4.1.1466.115.121.1.15</dsml:syntax></dsml:attribute-type></dsml:directory-schema></dsml:dsml>
 </schema>
 <attribute-inclusion><attribute>CITY_STATE</attribute><attribute>EMAIL</attribute><attribute>STREET</attribute><attribute>USER_FIRST_NAME</attribute><attribute>USER_ID</attribute><attribute>USER_LAST_NAME</attribute><attribute>ZIP</attribute><attribute>export_password</attribute></attribute-inclusion>
 <stay-disconnector />
 <join />
 <projection><class-mapping type="declared" id="{D6C8B054-A9F2-45BD-BF47-DCC75A379617}" cd-object-type="person"><mv-object-type>person</mv-object-type></class-mapping></projection>
 <export-attribute-flow />
 <provisioning-cleanup type="declared"><action>make-normal-disconnector</action></provisioning-cleanup>
 <extension />
 <controller-configuration>
 <application-protection>low</application-protection>
 <application-architecture>process</application-architecture>
</controller-configuration>

 <description></description>
 <ma-ui-settings><account-joiner-queries><attributes></attributes><filters max_mv_search_results=""></filters></account-joiner-queries></ma-ui-settings>
 <private-configuration>
  <MAConfig><ui-data><xmlwizard><properties><sample_file></sample_file><code_page_description></code_page_description></properties><partitions><partition cd_name="default" guid="{59F8C2B1-17B6-4B6D-8ABD-8F94FE5030C4}" version="0"><object_class>person</object_class></partition></partitions><primary_class_mappings><mapping object_class="person" primary_class="person" user_define="0"><attribute>USER_FIRST_NAME</attribute><attribute>USER_LAST_NAME</attribute><attribute>EMAIL</attribute><attribute>STREET</attribute><attribute>CITY_STATE</attribute><attribute>ZIP</attribute><attribute>USER_ID</attribute><attribute>export_password</attribute></mapping></primary_class_mappings><object_classes><object_class cd_name="person" selected="-1" user_define="0" configured="-1" anchor="" dn_as_anchor="0"><attribute mandatory="0">USER_FIRST_NAME</attribute><attribute mandatory="0">USER_LAST_NAME</attribute><attribute mandatory="0">EMAIL</attribute><attribute mandatory="0">STREET</attribute><attribute mandatory="0">CITY_STATE</attribute><attribute mandatory="0">ZIP</attribute><attribute mandatory="-1">USER_ID</attribute><attribute mandatory="0">export_password</attribute></object_class></object_classes><attributes><attribute cd_name="CITY_STATE" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="EMAIL" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="STREET" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="USER_FIRST_NAME" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="USER_ID" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="USER_LAST_NAME" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="ZIP" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /><attribute cd_name="export_password" sample_data="" binary="0" multi_valued="0" file_reference="0" selected="-1" lower_bound="" upper_bound="" type="String" user_define="0" /></attributes><anchor><attribute object_class="person">USER_ID</attribute></anchor></xmlwizard><ma-help-text>With this management agent, you can run Powershell scripts for import, export and password management.</ma-help-text><ma-help-text>With this management agent, you can run PowerShell scripts for import, export and password management.</ma-help-text></ui-data><importing><anchor><attribute object_class="person">USER_ID</attribute></anchor><per-class-settings><class><name>person</name><anchor><attribute>USER_ID</attribute></anchor></class></per-class-settings></importing><exporting></exporting><ldap-dn>0</ldap-dn><change_type_attribute></change_type_attribute><add_change_type_value>Add</add_change_type_value><modify_change_type_value>Modify</modify_change_type_value><delete_change_type_value>Delete</delete_change_type_value><primary_class_mappings><mapping><primary_class>person</primary_class><oc-value>person</oc-value></mapping></primary_class_mappings><enable-unapplied-merge>0</enable-unapplied-merge><password-extension-config><password-extension-enabled>0</password-extension-enabled><dll data-owner="ISV">Granfeldt.PowerShell.ManagementAgent.dll</dll><password-set-enabled>1</password-set-enabled><password-change-enabled>1</password-change-enabled><connection-info><connect-to></connect-to><user></user></connection-info><timeout>0</timeout></password-extension-config><file-type>Extensible2</file-type><extension-config><filename data-owner="ISV">Granfeldt.PowerShell.ManagementAgent.dll</filename><import-default-page-size>100</import-default-page-size><import-max-page-size>10000</import-max-page-size><export-default-page-size>100</export-default-page-size><export-max-page-size>9999</export-max-page-size><export-mode data-owner="ISV">call-based</export-mode><import-mode>call-based</import-mode><export-enabled data-owner="ISV">1</export-enabled><import-enabled data-owner="ISV">1</import-enabled><capability-bits>2181535792</capability-bits><export-type>3</export-type><discovery-partition></discovery-partition><discovery-schema>extensibility</discovery-schema><discovery-hierarchy></discovery-hierarchy><password-management-enabled>1</password-management-enabled><assembly-version>6.0.0.0</assembly-version><supports-parameters-ex>0</supports-parameters-ex></extension-config><parameter-definitions refreshSchema="0" refreshPartition="0" refreshConnectivityParameters="0" refreshGlobalParameters="0" refreshOtherParameters="0" refreshSchemaParameters="0" refreshCapabilitiesParameters="0"><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>The Schema script is called to retrieve the object and attribute definitions. This script should be accessible to the FIM Synchronization Service service account during configuration and refreshes of the schema.</text><default-value></default-value></parameter><parameter><name>Schema Script</name><use>connectivity</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>divider</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>Authentication (optional): These credentials are passed as parameters to all scripts.</text><default-value></default-value></parameter><parameter><name>Username</name><use>connectivity</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Password</name><use>connectivity</use><type>encrypted-string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Username (auxiliary)</name><use>connectivity</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Password (auxiliary)</name><use>connectivity</use><type>encrypted-string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>divider</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>Impersonation (optional): If username and password below are specified (domain optional), the specified user is used to run all scripts. If not specified, the scripts are run in the security context of the FIM Synchronization Service service account.</text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>NOTE: Impersonation with PowerShell 7 is not implemented. If impersonation credentials are provided and PowerShell 7 is selected, the system will automatically fall back to Windows PowerShell 5.1 for impersonated operations. WARNING: Scripts with PowerShell 7-specific syntax will fail in Windows PowerShell 5.1.</text><default-value></default-value></parameter><parameter><name>Domain (impersonate)</name><use>connectivity</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Username (impersonate)</name><use>connectivity</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Password  (impersonate)</name><use>connectivity</use><type>encrypted-string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>divider</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>PowerShell Engine Configuration: Select which PowerShell engine to use for script execution.</text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>PowerShell 7 provides better performance and modern features but impersonation is not implemented. When impersonation is required, the system automatically uses Windows PowerShell 5.1. Ensure scripts are compatible with both versions.</text><default-value></default-value></parameter><parameter><name>PowerShell Version</name><use>connectivity</use><type>drop-down</type><validation>Windows PowerShell 5.1,PowerShell 7</validation><text></text><default-value>Windows PowerShell 5.1</default-value><dropdown-extensible>0</dropdown-extensible></parameter><parameter><name>PowerShell 7 Executable Path</name><use>connectivity</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>divider</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>connectivity</use><type>label</type><validation></validation><text>Specify any additional configuration parameters to be passed to the Powershell scripts. Each value should be on a seperate line and key and value seperated by a comma or equal sign (i.e. Environment=PROD)</text><default-value></default-value></parameter><parameter><name>Configuration parameters</name><use>connectivity</use><type>text</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>global</use><type>label</type><validation></validation><text>Scripts</text><default-value></default-value></parameter><parameter><name></name><use>global</use><type>label</type><validation></validation><text>These are the PowerShell scripts that are run on the different operations. You should specify the full path of the scripts. Path cannot include spaces or similar whitespaces.</text><default-value></default-value></parameter><parameter><name>Import Script</name><use>global</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Export Script</name><use>global</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name>Use paged import</name><use>global</use><type>checkbox</type><validation></validation><text></text><default-value>0</default-value></parameter><parameter><name></name><use>global</use><type>divider</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>global</use><type>label</type><validation></validation><text>If you enable Password Management, this script is called for both password change and set (requires PCNS).</text><default-value></default-value></parameter><parameter><name>Password Management Script</name><use>global</use><type>string</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>global</use><type>divider</type><validation></validation><text></text><default-value></default-value></parameter><parameter><name></name><use>global</use><type>label</type><validation></validation><text>The objects piped to the export script will normally be of type PSCustomObject. If you uncheck this, you will get objects of more complex type CSEntryChange instead (legacy behaviour). For more information on the CSEntryChange object type, please see MSDN Library.</text><default-value></default-value></parameter><parameter><name>Export simple objects</name><use>global</use><type>checkbox</type><validation></validation><text></text><default-value>1</default-value></parameter></parameter-definitions><parameter-values><parameter name="Password" type="encrypted-string" use="connectivity" encrypted="1"></parameter><parameter name="Schema Script" type="string" use="connectivity">C:\Program Files\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions\PSMA7\schema.ps1</parameter><parameter name="Username" type="string" use="connectivity">appUserName</parameter><parameter name="Username (auxiliary)" type="string" use="connectivity"></parameter><parameter name="Domain (impersonate)" type="string" use="connectivity"></parameter><parameter name="Username (impersonate)" type="string" use="connectivity"></parameter><parameter name="PowerShell Version" type="drop-down" use="connectivity">PowerShell 7</parameter><parameter name="PowerShell 7 Executable Path" type="string" use="connectivity">C:\Program Files\PowerShell\7\pwsh.exe</parameter><parameter name="Configuration parameters" type="text" use="connectivity"></parameter><parameter name="Import Script" type="string" use="global">C:\Program Files\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions\PSMA7\import.ps1</parameter><parameter name="Export Script" type="string" use="global">C:\Program Files\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions\PSMA7\export.ps1</parameter><parameter name="Use paged import" type="checkbox" use="global">1</parameter><parameter name="Password Management Script" type="string" use="global">C:\Program Files\Microsoft Forefront Identity Manager\2010\Synchronization Service\Extensions\PSMA7\password.ps1</parameter><parameter name="Export simple objects" type="checkbox" use="global">1</parameter></parameter-values><default_visible_attributes><attribute>USER_ID</attribute><attribute>USER_FIRST_NAME</attribute><attribute>USER_LAST_NAME</attribute><attribute>EMAIL</attribute><attribute>STREET</attribute><attribute>CITY_STATE</attribute><attribute>ZIP</attribute></default_visible_attributes><case_normalize_dn_for_anchor>1</case_normalize_dn_for_anchor></MAConfig>
 </private-configuration>
 <SyncConfig-refresh-schema>0</SyncConfig-refresh-schema>
 <ma-partition-data>
 <partition>
  <id>{FEC6BB3A-D096-4689-B2FA-8EB5EE2BCA5C}</id>
  <name>default</name>
  <creation-time>2025-10-04 22:40:50.687</creation-time>
  <last-modification-time>2025-10-04 22:40:50.687</last-modification-time>
  <version>1</version>
  <selected>1</selected>
  <filter>
   <object-classes>
    <object-class>person</object-class>
   </object-classes>
   <containers>
    <exclusions/>
    <inclusions>
     <inclusion></inclusion>
    </inclusions>
   </containers>
  </filter>
  <custom-data>
   <ecma-partition-data><dn>default</dn><name>default</name><is-domain>1</is-domain></ecma-partition-data>
  </custom-data>
  <allowed-operations>1073741854</allowed-operations>
  <current>
   <batch-number>1</batch-number>
   <sequence-number>0</sequence-number>
  </current>
  <last-successful-batch>0</last-successful-batch>
  <filter-hints>
   <object-classes>
    <object-class>
     <name>person</name>
     <hierarchy>
      <object-class>person</object-class>
     </hierarchy>
     <included>1</included>
    </object-class>
   </object-classes>
  </filter-hints>
 </partition>
</ma-partition-data>

 <ma-run-data>
</ma-run-data>

 <capabilities-mask>82079831</capabilities-mask>
 <export-type>3</export-type>
 <dn-construction/>
 <password-sync><maximum-retry-count>10</maximum-retry-count><retry-interval>60</retry-interval><allow-low-security>0</allow-low-security><unlock-account>0</unlock-account></password-sync>
 <component_mappings />
</ma-data>

<mv-data>
 <import-attribute-flow><import-flow-set mv-object-type="person"><import-flows mv-attribute="employeeID" type="ranked"><import-flow src-ma="{EB7A26F4-9D3D-468A-80D9-3FFD101D40DD}" cd-object-type="user" id="{C2DAAB47-2DC2-4586-9D07-B35AC4B06F8F}"><direct-mapping><src-attribute>employeeID</src-attribute></direct-mapping></import-flow><import-flow src-ma="{D4417753-ABCF-450D-9F2C-DE69E5F168A9}" cd-object-type="person" id="{F93449CA-4DC1-467D-96E1-A961D2A1DFBB}"><direct-mapping><src-attribute>id</src-attribute></direct-mapping></import-flow><import-flow src-ma="{1D7E6A3F-C617-4257-8D69-565100BC6965}" cd-object-type="person" id="{925D847E-084C-4FFF-A882-80D5A8635CEA}"><direct-mapping><src-attribute>USER_ID</src-attribute></direct-mapping></import-flow></import-flows><import-flows mv-attribute="firstName" type="ranked"><import-flow src-ma="{1D7E6A3F-C617-4257-8D69-565100BC6965}" cd-object-type="person" id="{332FDA86-CC76-407A-9868-C0B53524E203}"><direct-mapping><src-attribute>USER_FIRST_NAME</src-attribute></direct-mapping></import-flow></import-flows><import-flows mv-attribute="lastName" type="ranked"><import-flow src-ma="{1D7E6A3F-C617-4257-8D69-565100BC6965}" cd-object-type="person" id="{5FE61009-12CF-4BA8-B3E5-6A4FE0C64005}"><direct-mapping><src-attribute>USER_LAST_NAME</src-attribute></direct-mapping></import-flow></import-flows><import-flows mv-attribute="employeeType" type="ranked"><import-flow src-ma="{EB7A26F4-9D3D-468A-80D9-3FFD101D40DD}" cd-object-type="user" id="{58A87152-B0E4-49F5-A29A-D6E7F30EB6A6}"><direct-mapping><src-attribute>extensionAttribute9</src-attribute></direct-mapping></import-flow><import-flow src-ma="{1D7E6A3F-C617-4257-8D69-565100BC6965}" cd-object-type="person" id="{22467B18-D88F-48C8-9F58-82CE05C0B45C}"><direct-mapping><src-attribute>USER_PROFILE</src-attribute></direct-mapping></import-flow></import-flows><import-flows mv-attribute="displayName" type="ranked"><import-flow src-ma="{D4417753-ABCF-450D-9F2C-DE69E5F168A9}" cd-object-type="person" id="{AEB343FE-8BBA-4C9C-855D-1572529A7308}"><direct-mapping><src-attribute>displayName</src-attribute></direct-mapping></import-flow></import-flows><import-flows mv-attribute="email" type="ranked"><import-flow src-ma="{4F71B1AD-92AB-4E73-80D1-52F0CCF6C598}" cd-object-type="person" id="{4F00F6CF-B3BF-41F8-804C-E2AB8A46FC38}"><direct-mapping><src-attribute>EMAIL</src-attribute></direct-mapping></import-flow><import-flow src-ma="{44D74A23-B80A-4BBD-9F1A-70E0781A5C0D}" cd-object-type="person" id="{CC7CE7B4-3CC6-4F54-809F-9FF2680EDA20}"><direct-mapping><src-attribute>EMAIL</src-attribute></direct-mapping></import-flow><import-flow src-ma="{D4417753-ABCF-450D-9F2C-DE69E5F168A9}" cd-object-type="person" id="{D6AA6B39-3F96-46A1-B5F0-651E615C85AF}"><direct-mapping><src-attribute>emailPrimary</src-attribute></direct-mapping></import-flow></import-flows><import-flows mv-attribute="mail" type="ranked"><import-flow src-ma="{EB7A26F4-9D3D-468A-80D9-3FFD101D40DD}" cd-object-type="user" id="{69B2C595-3E70-44B2-AC88-31B1F295F5BA}"><direct-mapping><src-attribute>mail</src-attribute></direct-mapping></import-flow></import-flows></import-flow-set><per-ma-options><ma-options ma-id="{1D7E6A3F-C617-4257-8D69-565100BC6965}"><enable-recall>true</enable-recall></ma-options><ma-options ma-id="{D4417753-ABCF-450D-9F2C-DE69E5F168A9}"><enable-recall>true</enable-recall></ma-options><ma-options ma-id="{EB7A26F4-9D3D-468A-80D9-3FFD101D40DD}"><enable-recall>true</enable-recall></ma-options><ma-options ma-id="{44D74A23-B80A-4BBD-9F1A-70E0781A5C0D}"><enable-recall>true</enable-recall></ma-options><ma-options ma-id="{4F71B1AD-92AB-4E73-80D1-52F0CCF6C598}"><enable-recall>true</enable-recall></ma-options></per-ma-options></import-attribute-flow>
</mv-data>

</export-ma>
